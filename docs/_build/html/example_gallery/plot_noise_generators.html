<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generation of stochastic noise &mdash; pysteps_tutorials  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Thunderstorm Detection and Tracking - T-DaTing" href="thunderstorm_detection_and_tracking.html" />
    <link rel="prev" title="Extrapolation nowcast" href="plot_extrapolation_nowcast.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pysteps_tutorials
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="plot_optical_flow.html">Optical flow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advection_correction.html">Advection correction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rainfarm_downscale.html">Precipitation downscaling with RainFARM</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="probability_forecast.html">Probability forecasts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot_extrapolation_nowcast.html">Extrapolation nowcast</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Generation of stochastic noise</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#read-precipitation-field">Read precipitation field</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parametric-filter">Parametric filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nonparametric-filter">Nonparametric filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#noise-generator">Noise generator</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="thunderstorm_detection_and_tracking.html">Thunderstorm Detection and Tracking - T-DaTing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_transformations.html">Data transformations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot_cascade_decomposition.html">Cascade decomposition</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot_steps_nowcast.html">STEPS nowcast</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="linda_nowcasts.html">LINDA nowcasts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot_ensemble_verification.html">Ensemble verification</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="LK_buffer_mask.html">Handling of no-data in Lucas-Kanade</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="anvil_nowcast.html">ANVIL nowcast</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="optical_flow_methods_convergence.html">Optical flow methods convergence</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pysteps_tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Generation of stochastic noise</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/example_gallery/plot_noise_generators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-example-gallery-plot-noise-generators-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="generation-of-stochastic-noise">
<span id="sphx-glr-example-gallery-plot-noise-generators-py"></span><h1>Generation of stochastic noise<a class="headerlink" href="#generation-of-stochastic-noise" title="Permalink to this headline"></a></h1>
<p>This example script shows how to run the stochastic noise field generators
included in pysteps.</p>
<p>These noise fields are used as perturbation terms during an extrapolation
nowcast in order to represent the uncertainty in the evolution of the rainfall
field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span><span class="p">,</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">pysteps</span> <span class="kn">import</span> <span class="n">io</span><span class="p">,</span> <span class="n">rcparams</span>
<span class="kn">from</span> <span class="nn">pysteps.noise.fftgenerators</span> <span class="kn">import</span> <span class="n">initialize_param_2d_fft_filter</span>
<span class="kn">from</span> <span class="nn">pysteps.noise.fftgenerators</span> <span class="kn">import</span> <span class="n">initialize_nonparam_2d_fft_filter</span>
<span class="kn">from</span> <span class="nn">pysteps.noise.fftgenerators</span> <span class="kn">import</span> <span class="n">generate_noise_2d_fft_filter</span>
<span class="kn">from</span> <span class="nn">pysteps.utils</span> <span class="kn">import</span> <span class="n">conversion</span><span class="p">,</span> <span class="n">rapsd</span><span class="p">,</span> <span class="n">transformation</span>
<span class="kn">from</span> <span class="nn">pysteps.visualization</span> <span class="kn">import</span> <span class="n">plot_precip_field</span><span class="p">,</span> <span class="n">plot_spectrum1d</span>
</pre></div>
</div>
<section id="read-precipitation-field">
<h2>Read precipitation field<a class="headerlink" href="#read-precipitation-field" title="Permalink to this headline"></a></h2>
<p>First thing,  the radar composite is imported and transformed in units
of dB.
This image will be used to train the Fourier filters that are necessary to
produce the fields of spatially correlated noise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the example radar composite</span>
<span class="n">root_path</span> <span class="o">=</span> <span class="n">rcparams</span><span class="o">.</span><span class="n">data_sources</span><span class="p">[</span><span class="s2">&quot;mch&quot;</span><span class="p">][</span><span class="s2">&quot;root_path&quot;</span><span class="p">]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_path</span><span class="p">,</span> <span class="s2">&quot;20160711&quot;</span><span class="p">,</span> <span class="s2">&quot;AQC161932100V_00005.801.gif&quot;</span><span class="p">)</span>
<span class="n">R</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">import_mch_gif</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;AQC&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">accutime</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>

<span class="c1"># Convert to mm/h</span>
<span class="n">R</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">conversion</span><span class="o">.</span><span class="n">to_rainrate</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Nicely print the metadata</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Plot the rainfall field</span>
<span class="n">plot_precip_field</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">geodata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Log-transform the data</span>
<span class="n">R</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">transformation</span><span class="o">.</span><span class="n">dB_transform</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">zerovalue</span><span class="o">=-</span><span class="mf">15.0</span><span class="p">)</span>

<span class="c1"># Assign the fill value to all the Nans</span>
<span class="n">R</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">R</span><span class="p">)]</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;zerovalue&quot;</span><span class="p">]</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_noise_generators_001.png" srcset="../_images/sphx_glr_plot_noise_generators_001.png" alt="mm/h" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;accutime&#39;: 5.0,
 &#39;cartesian_unit&#39;: &#39;m&#39;,
 &#39;institution&#39;: &#39;MeteoSwiss&#39;,
 &#39;product&#39;: &#39;AQC&#39;,
 &#39;projection&#39;: &#39;+proj=somerc  +lon_0=7.43958333333333 +lat_0=46.9524055555556 &#39;
               &#39;+k_0=1 +x_0=600000 +y_0=200000 +ellps=bessel &#39;
               &#39;+towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs&#39;,
 &#39;threshold&#39;: 0.01155375598376629,
 &#39;transform&#39;: None,
 &#39;unit&#39;: &#39;mm/h&#39;,
 &#39;x1&#39;: 255000.0,
 &#39;x2&#39;: 965000.0,
 &#39;xpixelsize&#39;: 1000.0,
 &#39;y1&#39;: -160000.0,
 &#39;y2&#39;: 480000.0,
 &#39;yorigin&#39;: &#39;upper&#39;,
 &#39;ypixelsize&#39;: 1000.0,
 &#39;zerovalue&#39;: 0.0,
 &#39;zr_a&#39;: 316.0,
 &#39;zr_b&#39;: 1.5}
</pre></div>
</div>
</section>
<section id="parametric-filter">
<h2>Parametric filter<a class="headerlink" href="#parametric-filter" title="Permalink to this headline"></a></h2>
<p>In the parametric approach, a power-law model is used to approximate the power
spectral density (PSD) of a given rainfall field.</p>
<p>The parametric model uses  a  piece-wise  linear  function  with  two  spectral
slopes (beta1 and beta2) and one breaking point</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the parametric PSD to the observation</span>
<span class="n">Fp</span> <span class="o">=</span> <span class="n">initialize_param_2d_fft_filter</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

<span class="c1"># Compute the observed and fitted 1D PSD</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Fp</span><span class="p">[</span><span class="s2">&quot;input_shape&quot;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">L</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">wn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">wn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">R_</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">rapsd</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">fft_method</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="p">,</span> <span class="n">return_freq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Fp</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">](</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">wn</span><span class="p">),</span> <span class="o">*</span><span class="n">Fp</span><span class="p">[</span><span class="s2">&quot;pars&quot;</span><span class="p">]))</span>

<span class="c1"># Extract the scaling break in km, beta1 and beta2</span>
<span class="n">w0</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Fp</span><span class="p">[</span><span class="s2">&quot;pars&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">Fp</span><span class="p">[</span><span class="s2">&quot;pars&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">Fp</span><span class="p">[</span><span class="s2">&quot;pars&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># Plot the observed power spectrum and the model</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_scales</span> <span class="o">=</span> <span class="p">[</span><span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">plot_spectrum1d</span><span class="p">(</span>
    <span class="n">freq</span><span class="p">,</span>
    <span class="n">R_</span><span class="p">,</span>
    <span class="n">x_units</span><span class="o">=</span><span class="s2">&quot;km&quot;</span><span class="p">,</span>
    <span class="n">y_units</span><span class="o">=</span><span class="s2">&quot;dBR&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observed&quot;</span><span class="p">,</span>
    <span class="n">wavelength_ticks</span><span class="o">=</span><span class="n">plot_scales</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot_spectrum1d</span><span class="p">(</span>
    <span class="n">freq</span><span class="p">,</span>
    <span class="n">f</span><span class="p">,</span>
    <span class="n">x_units</span><span class="o">=</span><span class="s2">&quot;km&quot;</span><span class="p">,</span>
    <span class="n">y_units</span><span class="o">=</span><span class="s2">&quot;dBR&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span>
    <span class="n">wavelength_ticks</span><span class="o">=</span><span class="n">plot_scales</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Radially averaged log-power spectrum of R</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">r</span><span class="s2">&quot;$\omega_0=</span><span class="si">%.0f</span><span class="s2"> km, \beta_1=</span><span class="si">%.1f</span><span class="s2">, \beta_2=</span><span class="si">%.1f</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_noise_generators_002.png" srcset="../_images/sphx_glr_plot_noise_generators_002.png" alt="Radially averaged log-power spectrum of R $\omega_0=68 km, \beta_1=-1.6, \beta_2=-3.2$" class = "sphx-glr-single-img"/></section>
<section id="nonparametric-filter">
<h2>Nonparametric filter<a class="headerlink" href="#nonparametric-filter" title="Permalink to this headline"></a></h2>
<p>In the nonparametric approach,  the Fourier filter is obtained directly
from the power spectrum of the observed precipitation field R.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fnp</span> <span class="o">=</span> <span class="n">initialize_nonparam_2d_fft_filter</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="noise-generator">
<h2>Noise generator<a class="headerlink" href="#noise-generator" title="Permalink to this headline"></a></h2>
<p>The parametric and nonparametric filters obtained above can now be used
to produce N realizations of random fields of prescribed power spectrum,
hence with the same correlation structure as the initial rainfall field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">num_realizations</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Generate noise</span>
<span class="n">Np</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Nnp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_realizations</span><span class="p">):</span>
    <span class="n">Np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_noise_2d_fft_filter</span><span class="p">(</span><span class="n">Fp</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span> <span class="o">+</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">Nnp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_noise_2d_fft_filter</span><span class="p">(</span><span class="n">Fnp</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span> <span class="o">+</span> <span class="n">k</span><span class="p">))</span>

<span class="c1"># Plot the generated noise fields</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># parametric noise</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Np</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Np</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Np</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># nonparametric noise</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Nnp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Nnp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Nnp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_noise_generators_003.png" srcset="../_images/sphx_glr_plot_noise_generators_003.png" alt="plot noise generators" class = "sphx-glr-single-img"/><p>The above figure highlights the main limitation of the parametric approach
(top row), that is, the assumption of an isotropic power law scaling
relationship, meaning that anisotropic structures such as rainfall bands
cannot be represented.</p>
<p>Instead, the nonparametric approach (bottom row) allows generating
perturbation fields with anisotropic  structures, but it also requires a
larger sample size and is sensitive to the quality of the input data, e.g.
the presence of residual clutter in the radar image.</p>
<p>In addition, both techniques assume spatial stationarity of the covariance
structure of the field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 3</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.421 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-example-gallery-plot-noise-generators-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/f0b5e06b52004befe02ca36f54306a52/plot_noise_generators.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_noise_generators.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/669bf73cf18efc85b073e756a75f7246/plot_noise_generators.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_noise_generators.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_extrapolation_nowcast.html" class="btn btn-neutral float-left" title="Extrapolation nowcast" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="thunderstorm_detection_and_tracking.html" class="btn btn-neutral float-right" title="Thunderstorm Detection and Tracking - T-DaTing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Pysteps developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>